<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<title>Luma Mate</title>

<link rel="stylesheet" href="style.css">

</head>

<body>

<header>

<h1>Luma Mate ğŸ§‰</h1>

<button onclick="abrirCarrito()">ğŸ›’ Carrito</button>

</header>

<div id="productos" class="grid"></div>

<div id="carrito" class="carrito">

<h2>Carrito</h2>

<div id="listaCarrito"></div>

<button onclick="comprar()">Comprar por WhatsApp</button>

<button onclick="cerrarCarrito()">Cerrar</button>

</div>

<script type="module">

import { db } from "./firebase.js"

import {
collection,
getDocs
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"

let carrito=[]

async function cargarProductos(){

const cont=document.getElementById("productos")

const querySnapshot=await getDocs(collection(db,"productos"))

querySnapshot.forEach(doc=>{

const p=doc.data()

cont.innerHTML+=`

<div class="card">

<img src="${p.imagen}">

<h3>${p.nombre}</h3>

<p>$${p.precio}</p>

<button onclick='agregar(${JSON.stringify(p)})'>Agregar</button>

</div>

`

})

}

window.agregar=function(p){

carrito.push(p)

renderCarrito()

}

function renderCarrito(){

const lista=document.getElementById("listaCarrito")

lista.innerHTML=""

carrito.forEach((p,i)=>{

lista.innerHTML+=`

<div>

${p.nombre} $${p.precio}

<button onclick="eliminar(${i})">âŒ</button>

</div>

`

})

}

window.eliminar=function(i){

carrito.splice(i,1)

renderCarrito()

}

window.abrirCarrito=function(){

document.getElementById("carrito").style.display="block"

}

window.cerrarCarrito=function(){

document.getElementById("carrito").style.display="none"

}

window.comprar=function(){

let numero="549299XXXXXXX"

let mensaje="Hola quiero comprar:%0A"

carrito.forEach(p=>{

mensaje+=p.nombre+" $"+p.precio+"%0A"

})

window.open("https://wa.me/"+numero+"?text="+mensaje)

}

cargarProductos()

</script>

</body>
</html>
